:root {
  --bg: #0b1220;
  --panel: #10182c;
  --panel-2: #0f1729;
  --text: #e7ecf6;
  --muted: #aab4c7;
  --accent: #4ecdc4;
  --accent-2: #f5a623;
  --danger: #ff6b6b;
  --good: #7bd88f;
  --grid: rgba(255,255,255,0.18);
  --highlight: rgba(78, 205, 196, 0.35);
  --roi: rgba(245, 166, 35, 0.22);
  --border: rgba(255,255,255,0.12);
}

* { box-sizing: border-box; }
html, body, #root { height: 100%; }
body {
  margin: 0;
  font-family: Inter, ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Noto Sans, Helvetica Neue, Arial, "Apple Color Emoji", "Segoe UI Emoji";
  color: var(--text);
  background: linear-gradient(180deg, #0b1220 0%, #0b1220 30%, #0e1630 100%);
}

.app {
  display: grid;
  grid-template-columns: 420px 1fr 380px;
  grid-template-rows: auto 1fr;
  grid-template-areas:
    "header header header"
    "left main right";
  gap: 12px;
  padding: 12px;
  height: 100%;
}

.header {
  grid-area: header;
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 10px 14px;
  display: flex;
  align-items: center;
  gap: 12px;
}
.header h1 {
  margin: 0;
  font-size: 18px;
  letter-spacing: 0.2px;
}
.header .spacer { flex: 1; }
.small {
  color: var(--muted);
  font-size: 12px;
}

.left, .main, .right {
  background: var(--panel);
  border: 1px solid var(--border);
  border-radius: 10px;
  padding: 12px;
  overflow: hidden;
}

.left { grid-area: left; display: flex; flex-direction: column; gap: 10px; }
.main { grid-area: main; position: relative; }
.right { grid-area: right; display: flex; flex-direction: column; gap: 10px; }

.section-title {
  font-size: 13px;
  color: var(--muted);
  text-transform: uppercase;
  letter-spacing: 0.1em;
  margin: 4px 0 8px;
}

.row { display: flex; align-items: center; gap: 8px; }
.row.wrap { flex-wrap: wrap; }
.row > * { flex: none; }
.row .grow { flex: 1; }

button, select, input[type="text"] {
  background: var(--panel-2);
  color: var(--text);
  border: 1px solid var(--border);
  border-radius: 8px;
  padding: 8px 10px;
  font-size: 14px;
}
button {
  cursor: pointer;
}
button.primary {
  background: #17325c;
  border-color: #244a86;
}
button.good { background: #123d28; border-color: #1f5f40; }
button.warn { background: #4d2f0e; border-color: #6d4c1b; }
button.danger { background: #42171b; border-color: #6a282f; }

label { font-size: 13px; color: var(--muted); }

input[type="range"] {
  width: 100%;
}

hr.sep {
  border: none;
  border-top: 1px solid var(--border);
  margin: 8px 0;
}

.video-wrap {
  position: relative;
  background: #0a0f1b;
  border-radius: 8px;
  border: 1px solid var(--border);
  overflow: hidden;
  height: calc(100% - 4px);
}

video {
  width: 100%;
  height: 100%;
  object-fit: contain;
  background: #000;
  display: block;
}

.video-wrap { position: relative; }

.overlay-canvas { 
  position: absolute; 
  inset: 0; 
  pointer-events: none; 
  z-index: 20; 
}

.overlay-layer { 
  position: absolute; 
  inset: 0; 
  pointer-events: auto; 
  z-index: 30; 
}

.roi-rect {
  position: absolute;
  border: 2px dashed var(--accent-2);
  background: var(--roi);
  pointer-events: auto;
  z-index: 40;
}

.roi-handle {
  position: absolute;
  width: 14px;
  height: 14px;
  border-radius: 3px;
  background: var(--accent-2);
  border: 1px solid #00000066;
  z-index: 41;
}

.roi-handle[data-corner="nw"] { left: -7px; top: -7px; cursor: nwse-resize; }
.roi-handle[data-corner="ne"] { right: -7px; top: -7px; cursor: nesw-resize; }
.roi-handle[data-corner="sw"] { left: -7px; bottom: -7px; cursor: nesw-resize; }
.roi-handle[data-corner="se"] { right: -7px; bottom: -7px; cursor: nwse-resize; }
.roi-handle[data-corner="n"]  { left: calc(50% - 7px); top: -7px; cursor: ns-resize; }
.roi-handle[data-corner="s"]  { left: calc(50% - 7px); bottom: -7px; cursor: ns-resize; }
.roi-handle[data-corner="w"]  { top: calc(50% - 7px); left: -7px; cursor: ew-resize; }
.roi-handle[data-corner="e"]  { top: calc(50% - 7px); right: -7px; cursor: ew-resize; }

.pattern-grid {
  display: grid;
  gap: 4px;
  background: var(--panel-2);
  padding: 8px;
  border: 1px solid var(--border);
  border-radius: 8px;
}
.pattern-cell {
  width: 28px; height: 28px;
  border-radius: 4px;
  display: grid;
  place-items: center;
  background: #0e1b34;
  color: var(--muted);
  font-size: 12px;
  border: 1px solid var(--border);
}
.pattern-cell.hit {
  background: #17325c;
  color: #fff;
  border-color: #244a86;
}
.pattern-cell.active {
  background: #1a4a3c;
  border-color: #2e7a60;
  color: #fff;
}

.kbd {
  font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
  background: #111a2e;
  color: #fff;
  border: 1px solid var(--border);
  border-radius: 6px;
  padding: 2px 6px;
  font-size: 12px;
}